---
import BaseLayout from "../../layouts/BaseLayout.astro";
import ArticleListItem from "../../components/ArticleListItem.astro";
import PaginationNav from "../../components/PaginationNav.astro";
import TagFilterBar from "../../components/TagFilterBar.astro";
import {
  getAllTagsByFrequency,
  getPaginatedArticles,
  getVisibleArticles,
} from "../../lib/articles";

const allArticles = await getVisibleArticles();
const tags = getAllTagsByFrequency(allArticles);
const { items, currentPage, totalPages } = getPaginatedArticles(allArticles, 1);
---

<BaseLayout title="Articles | Pedro Pinto" description="Articles on engineering, leadership, and software development.">
  <section class="max-w-3xl">
    <h1 class="font-heading text-4xl text-[var(--color-text)]">Articles</h1>
    <p class="mt-3 text-[var(--color-muted)]">Notes on engineering, leadership, and software.</p>
  </section>

  <TagFilterBar tags={tags} />

  <section class="mt-8 grid gap-4">
    {items.length === 0 ? (
      <p class="text-[var(--color-muted)]">No published articles yet.</p>
    ) : (
      items.map((article) => <ArticleListItem article={article} />)
    )}
  </section>

  <PaginationNav currentPage={currentPage} totalPages={totalPages} />
</BaseLayout>
